import{r as f,aE as $e,aF as Me,aG as Y,aH as re,d as De,aq as Ee,ar as Pe,as as Ae,at as ze,a9 as Ie,aa as Le,B as Ne,aI as Ve,J as je,m as Fe,a3 as He,p as M,aJ as Ke,aK as Ge,z as Re,aL as We,aB as Ye,a1 as ce,q as me,Q as j,aM as ve,aj as ye,aN as Ue,k as Xe,h as D,t as E,o as d,w as A,aO as qe,aP as Z,H as v,c as P,a4 as x,f as z,b as _,ap as pe,n as ee,l as B,aQ as oe,au as Ce,R as le,g as ne,v as te,aR as Je,S as Qe,T as Ze,aS as xe,aT as ae,ai as _e,aU as be,a2 as eo}from"./index-CWkTdfTI.js";import{K as oo}from"./index-Cnpsw9AU.js";const lo=e=>{const o=f(!1),t={overflow:"",width:"",boxSizing:""};return{setOverflowHidden:()=>{if(e.value){const l=e.value;if(!o.value&&l.style.overflow!=="hidden"){const i=$e(l);(i>0||Me(l))&&(t.overflow=l.style.overflow,t.width=l.style.width,t.boxSizing=l.style.boxSizing,l.style.overflow="hidden",l.style.width=`${l.offsetWidth-i}px`,l.style.boxSizing="border-box",o.value=!0)}}},resetOverflow:()=>{if(e.value&&o.value){const l=e.value;l.style.overflow=t.overflow,l.style.width=t.width,l.style.boxSizing=t.boxSizing,o.value=!1}}}},no=({modalRef:e,wrapperRef:o,draggable:t,alignCenter:c})=>{const r=f(!1),l=f([0,0]),i=f([0,0]),y=f(),p=f([0,0]),n=f([0,0]),u=()=>{var s,S,O;if(o.value&&e.value){const{top:k,left:w}=o.value.getBoundingClientRect(),{clientWidth:F,clientHeight:H}=o.value,{top:I,left:K,width:L,height:N}=e.value.getBoundingClientRect(),T=c.value?0:(s=e.value)==null?void 0:s.offsetTop,C=K-w,G=I-k-T;(C!==((S=i.value)==null?void 0:S[0])||G!==((O=i.value)==null?void 0:O[1]))&&(i.value=[C,G]);const V=F>L?F-L:0,R=H>N?H-N-T:0;(V!==n.value[0]||R!==n.value[1])&&(n.value=[V,R]),T&&(p.value=[0,0-T])}},m=s=>{t.value&&(s.preventDefault(),r.value=!0,u(),l.value=[s.x,s.y],Y(window,"mousemove",b),Y(window,"mouseup",g),Y(window,"contextmenu",g))},b=s=>{if(r.value){const S=s.x-l.value[0],O=s.y-l.value[1];let k=i.value[0]+S,w=i.value[1]+O;k<p.value[0]&&(k=p.value[0]),k>n.value[0]&&(k=n.value[0]),w<p.value[1]&&(w=p.value[1]),w>n.value[1]&&(w=n.value[1]),y.value=[k,w]}},g=()=>{r.value=!1,re(window,"mousemove",b),re(window,"mouseup",g)};return{position:y,handleMoveDown:m}};var to=De({name:"Modal",components:{ClientOnly:Ve,ArcoButton:Ne,IconHover:Le,IconClose:Ie,IconInfoCircleFill:ze,IconCheckCircleFill:Ae,IconExclamationCircleFill:Pe,IconCloseCircleFill:Ee},inheritAttrs:!1,props:{visible:{type:Boolean,default:void 0},defaultVisible:{type:Boolean,default:!1},width:{type:[Number,String]},top:{type:[Number,String]},mask:{type:Boolean,default:!0},title:{type:String},titleAlign:{type:String,default:"center"},alignCenter:{type:Boolean,default:!0},unmountOnClose:Boolean,maskClosable:{type:Boolean,default:!0},hideCancel:{type:Boolean,default:!1},simple:{type:Boolean,default:e=>e.notice},closable:{type:Boolean,default:!0},okText:String,cancelText:String,okLoading:{type:Boolean,default:!1},okButtonProps:{type:Object},cancelButtonProps:{type:Object},footer:{type:Boolean,default:!0},renderToBody:{type:Boolean,default:!0},popupContainer:{type:[String,Object],default:"body"},maskStyle:{type:Object},modalClass:{type:[String,Array]},modalStyle:{type:Object},onBeforeOk:{type:Function},onBeforeCancel:{type:Function},escToClose:{type:Boolean,default:!0},draggable:{type:Boolean,default:!1},fullscreen:{type:Boolean,default:!1},maskAnimationName:{type:String,default:e=>e.fullscreen?"fade-in-standard":"fade-modal"},modalAnimationName:{type:String,default:e=>e.fullscreen?"zoom-in":"zoom-modal"},bodyClass:{type:[String,Array]},bodyStyle:{type:[String,Object,Array]},messageType:{type:String},hideTitle:{type:Boolean,default:!1}},emits:{"update:visible":e=>!0,ok:e=>!0,cancel:e=>!0,open:()=>!0,close:()=>!0,beforeOpen:()=>!0,beforeClose:()=>!0},setup(e,{emit:o}){const{fullscreen:t,popupContainer:c,alignCenter:r}=je(e),l=Fe("modal"),{t:i}=He(),y=f(),p=f(),n=f(e.defaultVisible),u=M(()=>{var a;return(a=e.visible)!=null?a:n.value}),m=f(!1),b=M(()=>e.okLoading||m.value),g=M(()=>e.draggable&&!e.fullscreen),{teleportContainer:s,containerRef:S}=Ke({popupContainer:c,visible:u}),O=f(u.value),k=M(()=>e.okText||i("modal.okText")),w=M(()=>e.cancelText||i("modal.cancelText")),{zIndex:F,isLastDialog:H}=Ge("dialog",{visible:u});let I=!1;const K=a=>{e.escToClose&&a.key===oo.ESC&&H()&&X(a)},L=()=>{e.escToClose&&!I&&(I=!0,Y(document.documentElement,"keydown",K))},N=()=>{I=!1,re(document.documentElement,"keydown",K)};let T=0;const{position:C,handleMoveDown:G}=no({wrapperRef:y,modalRef:p,draggable:g,alignCenter:r}),V=()=>{T++,m.value&&(m.value=!1),n.value=!1,o("update:visible",!1)},R=async a=>{const h=T,W=await new Promise(async J=>{var fe;if(j(e.onBeforeOk)){let $=e.onBeforeOk((Q=!0)=>J(Q));if((ve($)||!ye($))&&(m.value=!0),ve($))try{$=(fe=await $)!=null?fe:!0}catch(Q){throw $=!1,Q}ye($)&&J($)}else J(!0)});h===T&&(W?(o("ok",a),V()):m.value&&(m.value=!1))},X=a=>{var h;let W=!0;j(e.onBeforeCancel)&&(W=(h=e.onBeforeCancel())!=null?h:!1),W&&(o("cancel",a),V())},q=f(!1),ke=a=>{a.target===y.value&&(q.value=!0)},we=a=>{e.mask&&e.maskClosable&&q.value&&X(a)},he=()=>{u.value&&(!Ue(y.value,document.activeElement)&&document.activeElement instanceof HTMLElement&&document.activeElement.blur(),o("open"))},Be=()=>{u.value||(g.value&&(C.value=void 0),O.value=!1,de(),o("close"))},{setOverflowHidden:ue,resetOverflow:de}=lo(S);Re(()=>{S.value=We(e.popupContainer),u.value&&(ue(),e.escToClose&&L())}),Ye(()=>{de(),N()}),ce(u,a=>{n.value!==a&&(n.value=a),a?(o("beforeOpen"),O.value=!0,q.value=!1,ue(),L()):(o("beforeClose"),N())}),ce(t,()=>{C.value&&(C.value=void 0)});const Se=M(()=>[`${l}-wrapper`,{[`${l}-wrapper-align-center`]:e.alignCenter&&!e.fullscreen,[`${l}-wrapper-moved`]:!!C.value}]),Oe=M(()=>[`${l}`,e.modalClass,{[`${l}-simple`]:e.simple,[`${l}-draggable`]:g.value,[`${l}-fullscreen`]:e.fullscreen}]),Te=M(()=>{var a;const h={...(a=e.modalStyle)!=null?a:{}};return e.width&&!e.fullscreen&&(h.width=me(e.width)?`${e.width}px`:e.width),!e.alignCenter&&e.top&&(h.top=me(e.top)?`${e.top}px`:e.top),C.value&&(h.transform=`translate(${C.value[0]}px, ${C.value[1]}px)`),h});return{prefixCls:l,mounted:O,computedVisible:u,containerRef:S,wrapperRef:y,mergedModalStyle:Te,okDisplayText:k,cancelDisplayText:w,zIndex:F,handleOk:R,handleCancel:X,handleMaskClick:we,handleMaskMouseDown:ke,handleOpen:he,handleClose:Be,mergedOkLoading:b,modalRef:p,wrapperCls:Se,modalCls:Oe,teleportContainer:s,handleMoveDown:G}}});function ao(e,o,t,c,r,l){const i=D("icon-info-circle-fill"),y=D("icon-check-circle-fill"),p=D("icon-exclamation-circle-fill"),n=D("icon-close-circle-fill"),u=D("icon-close"),m=D("icon-hover"),b=D("arco-button"),g=D("client-only");return d(),E(g,null,{default:A(()=>[(d(),E(qe,{to:e.teleportContainer,disabled:!e.renderToBody},[!e.unmountOnClose||e.computedVisible||e.mounted?Z((d(),P("div",x({key:0,class:`${e.prefixCls}-container`,style:{zIndex:e.zIndex}},e.$attrs),[z(pe,{name:e.maskAnimationName,appear:""},{default:A(()=>[e.mask?Z((d(),P("div",{key:0,ref:"maskRef",class:B(`${e.prefixCls}-mask`),style:ee(e.maskStyle)},null,6)),[[oe,e.computedVisible]]):v("v-if",!0)]),_:1},8,["name"]),_("div",{ref:"wrapperRef",class:B(e.wrapperCls),onClick:o[2]||(o[2]=Ce((...s)=>e.handleMaskClick&&e.handleMaskClick(...s),["self"])),onMousedown:o[3]||(o[3]=Ce((...s)=>e.handleMaskMouseDown&&e.handleMaskMouseDown(...s),["self"]))},[z(pe,{name:e.modalAnimationName,appear:"",onAfterEnter:e.handleOpen,onAfterLeave:e.handleClose,persisted:""},{default:A(()=>[Z(_("div",{ref:"modalRef",class:B(e.modalCls),style:ee(e.mergedModalStyle)},[!e.hideTitle&&(e.$slots.title||e.title||e.closable)?(d(),P("div",{key:0,class:B(`${e.prefixCls}-header`),onMousedown:o[1]||(o[1]=(...s)=>e.handleMoveDown&&e.handleMoveDown(...s))},[e.$slots.title||e.title?(d(),P("div",{key:0,class:B([`${e.prefixCls}-title`,`${e.prefixCls}-title-align-${e.titleAlign}`])},[e.messageType?(d(),P("div",{key:0,class:B(`${e.prefixCls}-title-icon`)},[e.messageType==="info"?(d(),E(i,{key:0})):v("v-if",!0),e.messageType==="success"?(d(),E(y,{key:1})):v("v-if",!0),e.messageType==="warning"?(d(),E(p,{key:2})):v("v-if",!0),e.messageType==="error"?(d(),E(n,{key:3})):v("v-if",!0)],2)):v("v-if",!0),le(e.$slots,"title",{},()=>[ne(te(e.title),1)])],2)):v("v-if",!0),!e.simple&&e.closable?(d(),P("div",{key:1,tabindex:"-1",role:"button","aria-label":"Close",class:B(`${e.prefixCls}-close-btn`),onClick:o[0]||(o[0]=(...s)=>e.handleCancel&&e.handleCancel(...s))},[z(m,null,{default:A(()=>[z(u)]),_:1})],2)):v("v-if",!0)],34)):v("v-if",!0),_("div",{class:B([`${e.prefixCls}-body`,e.bodyClass]),style:ee(e.bodyStyle)},[le(e.$slots,"default")],6),e.footer?(d(),P("div",{key:1,class:B(`${e.prefixCls}-footer`)},[le(e.$slots,"footer",{},()=>[e.hideCancel?v("v-if",!0):(d(),E(b,x({key:0},e.cancelButtonProps,{onClick:e.handleCancel}),{default:A(()=>[ne(te(e.cancelDisplayText),1)]),_:1},16,["onClick"])),z(b,x({type:"primary"},e.okButtonProps,{loading:e.mergedOkLoading,onClick:e.handleOk}),{default:A(()=>[ne(te(e.okDisplayText),1)]),_:1},16,["loading","onClick"])])],2)):v("v-if",!0)],6),[[oe,e.computedVisible]])]),_:3},8,["name","onAfterEnter","onAfterLeave"])],34)],16)),[[oe,e.computedVisible||e.mounted]]):v("v-if",!0)],8,["to","disabled"]))]),_:3})}var U=Xe(to,[["render",ao]]);const se=(e,o)=>{let t=xe("modal");const c=()=>{n.component&&(n.component.props.visible=!1),j(e.onOk)&&e.onOk()},r=()=>{n.component&&(n.component.props.visible=!1),j(e.onCancel)&&e.onCancel()},l=async()=>{await eo(),t&&(be(null,t),document.body.removeChild(t)),t=null,j(e.onClose)&&e.onClose()},i=()=>{n.component&&(n.component.props.visible=!1)},y=u=>{n.component&&Object.entries(u).forEach(([m,b])=>{n.component.props[m]=b})},n=z(U,{...{visible:!0,renderToBody:!1,unmountOnClose:!0,onOk:c,onCancel:r,onClose:l},..._e(e,["content","title","footer","visible","unmountOnClose","onOk","onCancel","onClose"]),footer:typeof e.footer=="boolean"?e.footer:void 0},{default:ae(e.content),title:ae(e.title),footer:typeof e.footer!="boolean"?ae(e.footer):void 0});return(o??ge._context)&&(n.appContext=o??ge._context),be(n,t),document.body.appendChild(t),{close:i,update:y}},ie={open:se,confirm:(e,o)=>{const t={simple:!0,messageType:"warning",...e};return se(t,o)},...Je.reduce((e,o)=>(e[o]=(t,c)=>{const r={simple:!0,hideCancel:!0,messageType:o,...t};return se(r,c)},e),{})},ge=Object.assign(U,{...ie,install:(e,o)=>{Qe(e,o);const t=Ze(o);e.component(t+U.name,U);const c={};for(const r of Object.keys(ie))c[r]=(l,i=e._context)=>ie[r](l,i);e.config.globalProperties.$modal=c},_context:null});export{ge as M};
