import{d as C,r as x,p as h,z as B,c as a,o as n,b as e,v as l,f as d,j as i,A as E,C as k,D as U,E as R,w as c,h as G,F as w,s as D,g as u,l as S}from"./index-CWkTdfTI.js";import{T as H}from"./index-BnQlv6tf.js";const P={class:"p-6"},A={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},F={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},L={class:"flex items-center justify-between"},O={class:"text-2xl font-bold text-gray-900"},T={class:"w-12 h-12 bg-blue-50 rounded-lg flex items-center justify-center"},V={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},z={class:"flex items-center justify-between"},M={class:"text-2xl font-bold text-green-600"},W={class:"text-xs text-gray-500"},q={class:"w-12 h-12 bg-green-50 rounded-lg flex items-center justify-center"},J={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},K={class:"flex items-center justify-between"},Q={class:"text-2xl font-bold text-blue-600"},X={class:"w-12 h-12 bg-blue-50 rounded-lg flex items-center justify-center"},Y={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},Z={class:"flex items-center justify-between"},$={class:"text-2xl font-bold text-purple-600"},ee={class:"w-12 h-12 bg-purple-50 rounded-lg flex items-center justify-center"},te={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},se={class:"bg-white rounded-lg shadow-sm border border-gray-200"},oe={class:"p-6 border-b border-gray-200"},le={class:"flex items-center justify-between"},re={class:"p-6"},ae={key:0,class:"text-center py-8 text-gray-500"},ne={key:1,class:"space-y-4"},de={class:"flex items-center space-x-3"},ie={class:"font-medium text-gray-900"},ce={class:"text-sm text-gray-500"},ue={class:"bg-white rounded-lg shadow-sm border border-gray-200"},ge={class:"p-6 border-b border-gray-200"},_e={class:"flex items-center justify-between"},xe={class:"p-6"},pe={key:0,class:"text-center py-8 text-gray-500"},be={key:1,class:"space-y-4"},fe={class:"flex items-center space-x-3"},me={class:"font-medium text-gray-900"},ye={class:"text-sm text-gray-500"},De=C({__name:"DashboardView",setup(ve){const r=x({totalProjects:0,totalHosts:0,onlineHosts:0,offlineHosts:0,runningBuilds:0,successBuilds:0,failedBuilds:0,runningDeploys:0,successDeploys:0,failedDeploys:0,totalImageRepos:0,totalBuildNodes:0,onlineBuildNodes:0,offlineBuildNodes:0}),g=x([]),_=x([]),N=h(()=>{const s=r.value.successBuilds+r.value.failedBuilds;return s>0?Math.round(r.value.successBuilds/s*100):0}),I=h(()=>{const s=r.value.successDeploys+r.value.failedDeploys;return s>0?Math.round(r.value.successDeploys/s*100):0});function p(s){switch(s){case"SUCCESS":return"bg-green-500";case"FAILED":return"bg-red-500";case"RUNNING":return"bg-blue-500";case"PENDING":return"bg-yellow-500";default:return"bg-gray-500"}}function b(s){switch(s){case"SUCCESS":return"green";case"FAILED":return"red";case"RUNNING":return"blue";case"PENDING":return"orange";default:return"gray"}}function f(s){switch(s){case"SUCCESS":return"成功";case"FAILED":return"失败";case"RUNNING":return"运行中";case"PENDING":return"等待中";default:return"未知"}}function m(s){return new Date(s).toLocaleString("zh-CN")}async function j(){try{r.value={totalProjects:12,totalHosts:8,onlineHosts:6,offlineHosts:2,runningBuilds:2,successBuilds:45,failedBuilds:3,runningDeploys:1,successDeploys:38,failedDeploys:2,totalImageRepos:55,totalBuildNodes:55,onlineBuildNodes:55,offlineBuildNodes:55},g.value=[{id:1,type:"build",project_name:"Web前端项目",status:"SUCCESS",created_at:new Date().toISOString()},{id:2,type:"build",project_name:"API服务",status:"RUNNING",created_at:new Date(Date.now()-3e5).toISOString()},{id:3,type:"build",project_name:"数据处理服务",status:"FAILED",created_at:new Date(Date.now()-6e5).toISOString()}],_.value=[{id:1,type:"deploy",project_name:"Web前端项目",status:"SUCCESS",created_at:new Date().toISOString(),host_name:"生产服务器1"},{id:2,type:"deploy",project_name:"API服务",status:"RUNNING",created_at:new Date(Date.now()-18e4).toISOString(),host_name:"生产服务器2"}]}catch(s){console.error("加载Dashboard数据失败:",s)}}return B(()=>{j()}),(s,t)=>{const y=G("router-link"),v=H;return n(),a("div",P,[t[10]||(t[10]=e("div",{class:"mb-6"},[e("h1",{class:"text-2xl font-bold text-gray-900 mb-2"}," 控制台 "),e("p",{class:"text-gray-600"}," DevOps平台概览 ")],-1)),e("div",A,[e("div",F,[e("div",L,[e("div",null,[t[0]||(t[0]=e("p",{class:"text-sm font-medium text-gray-600"}," 项目总数 ",-1)),e("p",O,l(r.value.totalProjects),1)]),e("div",T,[d(i(E),{class:"text-blue-600 text-xl"})])])]),e("div",V,[e("div",z,[e("div",null,[t[1]||(t[1]=e("p",{class:"text-sm font-medium text-gray-600"}," 在线主机 ",-1)),e("p",M,l(r.value.onlineHosts),1),e("p",W," 总计 "+l(r.value.totalHosts)+" 台 ",1)]),e("div",q,[d(i(k),{class:"text-green-600 text-xl"})])])]),e("div",J,[e("div",K,[e("div",null,[t[2]||(t[2]=e("p",{class:"text-sm font-medium text-gray-600"}," 构建成功率 ",-1)),e("p",Q,l(N.value)+"% ",1),t[3]||(t[3]=e("p",{class:"text-xs text-gray-500"}," 最近30天 ",-1))]),e("div",X,[d(i(U),{class:"text-blue-600 text-xl"})])])]),e("div",Y,[e("div",Z,[e("div",null,[t[4]||(t[4]=e("p",{class:"text-sm font-medium text-gray-600"}," 部署成功率 ",-1)),e("p",$,l(I.value)+"% ",1),t[5]||(t[5]=e("p",{class:"text-xs text-gray-500"}," 最近30天 ",-1))]),e("div",ee,[d(i(R),{class:"text-purple-600 text-xl"})])])])]),e("div",te,[e("div",se,[e("div",oe,[e("div",le,[t[7]||(t[7]=e("h3",{class:"text-lg font-semibold text-gray-900"}," 最近构建 ",-1)),d(y,{to:"/builds",class:"text-blue-600 hover:text-blue-700 text-sm font-medium"},{default:c(()=>t[6]||(t[6]=[u(" 查看全部 ",-1)])),_:1,__:[6]})])]),e("div",re,[g.value.length===0?(n(),a("div",ae," 暂无构建记录 ")):(n(),a("div",ne,[(n(!0),a(w,null,D(g.value,o=>(n(),a("div",{key:o.id,class:"flex items-center justify-between py-3 border-b border-gray-100 last:border-b-0"},[e("div",de,[e("div",{class:S(["w-2 h-2 rounded-full",p(o.status)])},null,2),e("div",null,[e("p",ie,l(o.project_name),1),e("p",ce,l(m(o.created_at)),1)])]),d(v,{color:b(o.status)},{default:c(()=>[u(l(f(o.status)),1)]),_:2},1032,["color"])]))),128))]))])]),e("div",ue,[e("div",ge,[e("div",_e,[t[9]||(t[9]=e("h3",{class:"text-lg font-semibold text-gray-900"}," 最近部署 ",-1)),d(y,{to:"/deploys",class:"text-blue-600 hover:text-blue-700 text-sm font-medium"},{default:c(()=>t[8]||(t[8]=[u(" 查看全部 ",-1)])),_:1,__:[8]})])]),e("div",xe,[_.value.length===0?(n(),a("div",pe," 暂无部署记录 ")):(n(),a("div",be,[(n(!0),a(w,null,D(_.value,o=>(n(),a("div",{key:o.id,class:"flex items-center justify-between py-3 border-b border-gray-100 last:border-b-0"},[e("div",fe,[e("div",{class:S(["w-2 h-2 rounded-full",p(o.status)])},null,2),e("div",null,[e("p",me,l(o.project_name),1),e("p",ye,l(o.host_name)+" • "+l(m(o.created_at)),1)])]),d(v,{color:b(o.status)},{default:c(()=>[u(l(f(o.status)),1)]),_:2},1032,["color"])]))),128))]))])])])])}}});export{De as default};
