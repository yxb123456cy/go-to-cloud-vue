import{k as Ce,d as be,h as E,c as y,o as S,E as F,f as M,P as we,n as ye,l as O,t as P,w as ee,b as Se,a2 as ae,a7 as ze,a8 as Ve,ak as $e,G as Le,m as Be,a9 as Re,r as d,p as v,$ as j,J as z,s as Ie,ag as xe,O as Te,al as te,a0 as le,V as ke,am as Ne,Q as He,R as Ae}from"./index-DpkOdSpx.js";import{e as Ee,p as Fe}from"./index-NTQZ5pKC.js";const Me=["border-width","box-sizing","font-family","font-weight","font-size","font-variant","letter-spacing","line-height","padding-top","padding-bottom","padding-left","padding-right","text-indent","text-rendering","text-transform","white-space","overflow-wrap","width"],Oe=e=>{const t={};return Me.forEach(f=>{t[f]=e.getPropertyValue(f)}),t},Pe=be({name:"Textarea",components:{ResizeObserver:$e,IconHover:Ve,IconClose:ze},inheritAttrs:!1,props:{modelValue:String,defaultValue:{type:String,default:""},placeholder:String,disabled:{type:Boolean,default:!1},error:{type:Boolean,default:!1},maxLength:{type:[Number,Object],default:0},showWordLimit:{type:Boolean,default:!1},allowClear:{type:Boolean,default:!1},autoSize:{type:[Boolean,Object],default:!1},wordLength:{type:Function},wordSlice:{type:Function},textareaAttrs:{type:Object}},emits:{"update:modelValue":e=>!0,input:(e,t)=>!0,change:(e,t)=>!0,clear:e=>!0,focus:e=>!0,blur:e=>!0},setup(e,{emit:t,attrs:f}){const{disabled:W,error:G,modelValue:h}=Le(e),m=Be("textarea"),{mergedDisabled:c,mergedError:V,eventHandlers:o}=Re({disabled:W,error:G}),s=d(),U=d(),p=d(),J=d(),$=d(e.defaultValue),i=v(()=>{var a;return(a=h.value)!=null?a:$.value}),[oe,ne]=Ee(s);j(h,a=>{(ke(a)||Ne(a))&&($.value="")});const C=v(()=>z(e.maxLength)&&!!e.maxLength.errorOnly),u=v(()=>z(e.maxLength)?e.maxLength.length:e.maxLength),b=a=>{var l;return Te(e.wordLength)?e.wordLength(a):(l=a.length)!=null?l:0},Q=v(()=>b(i.value)),q=v(()=>V.value||!!(u.value&&C.value&&Q.value>u.value)),g=d(!1),L=d(!1),re=v(()=>e.allowClear&&!c.value&&i.value),B=d(!1),K=d(""),R=()=>{oe(),le(()=>{s.value&&i.value!==s.value.value&&(s.value.value=i.value,ne())})},w=(a,l=!0)=>{var n,r;u.value&&!C.value&&b(a)>u.value&&(a=(r=(n=e.wordSlice)==null?void 0:n.call(e,a,u.value))!=null?r:a.slice(0,u.value)),$.value=a,l&&t("update:modelValue",a),R()};let I=i.value;const X=(a,l)=>{var n,r;a!==I&&(I=a,t("change",a,l),(r=(n=o.value)==null?void 0:n.onChange)==null||r.call(n,l))},se=a=>{var l,n;L.value=!0,I=i.value,t("focus",a),(n=(l=o.value)==null?void 0:l.onFocus)==null||n.call(l,a)},ue=a=>{var l,n;L.value=!1,t("blur",a),(n=(l=o.value)==null?void 0:l.onBlur)==null||n.call(l,a),X(i.value,a)},ie=a=>{var l,n;const{value:r}=a.target;if(a.type==="compositionend"){if(B.value=!1,K.value="",u.value&&!C.value&&i.value.length>=u.value&&b(r)>u.value){R();return}t("input",r,a),w(r),(n=(l=o.value)==null?void 0:l.onInput)==null||n.call(l,a)}else B.value=!0},de=a=>{var l,n;const{value:r}=a.target;if(B.value)K.value=r;else{if(u.value&&!C.value&&i.value.length>=u.value&&b(r)>u.value&&a.inputType==="insertText"){R();return}t("input",r,a),w(r),(n=(l=o.value)==null?void 0:l.onInput)==null||n.call(l,a)}},ve=a=>{w(""),X("",a),t("clear",a)};j(h,a=>{a!==i.value&&w(a??"",!1)});const fe=a=>xe(f,te),Y=a=>Fe(f,te),me=Y(),ce=v(()=>{const a={...me,...e.textareaAttrs};return q.value&&(a["aria-invalid"]=!0),a}),ge=v(()=>[`${m}-wrapper`,{[`${m}-focus`]:L.value,[`${m}-disabled`]:c.value,[`${m}-error`]:q.value,[`${m}-scroll`]:g.value}]);let Z;const x=d(0),T=d(0),k=v(()=>!z(e.autoSize)||!e.autoSize.minRows?0:e.autoSize.minRows*x.value+T.value),N=v(()=>!z(e.autoSize)||!e.autoSize.maxRows?0:e.autoSize.maxRows*x.value+T.value),H=()=>{const a=Oe(Z);x.value=Number.parseInt(a["line-height"]||0,10),T.value=Number.parseInt(a["border-width"]||0,10)*2+Number.parseInt(a["padding-top"]||0,10)+Number.parseInt(a["padding-bottom"]||0,10),J.value=a,le(()=>{var l;const n=(l=p.value)==null?void 0:l.offsetHeight;let r=n??0,_="hidden";k.value&&r<k.value&&(r=k.value),N.value&&r>N.value&&(r=N.value,_="auto"),U.value={height:`${r}px`,resize:"none",overflow:_}})};Ie(()=>{s.value&&(Z=window.getComputedStyle(s.value),e.autoSize&&H()),A()});const he=()=>{e.autoSize&&p.value&&H(),A()},pe=a=>{s.value&&a.target!==s.value&&(a.preventDefault(),s.value.focus())},A=()=>{s.value&&(s.value.scrollHeight>s.value.offsetHeight?g.value||(g.value=!0):g.value&&(g.value=!1))};return j(i,()=>{e.autoSize&&p.value&&H(),A()}),{prefixCls:m,wrapperCls:ge,textareaRef:s,textareaStyle:U,mirrorRef:p,mirrorStyle:J,computedValue:i,showClearBtn:re,valueLength:Q,computedMaxLength:u,mergedDisabled:c,mergeTextareaAttrs:ce,getWrapperAttrs:fe,getTextareaAttrs:Y,handleInput:de,handleFocus:se,handleBlur:ue,handleComposition:ie,handleClear:ve,handleResize:he,handleMousedown:pe}},methods:{focus(){var e;(e=this.$refs.textareaRef)==null||e.focus()},blur(){var e;(e=this.$refs.textareaRef)==null||e.blur()}}}),je=["disabled","value","placeholder"];function De(e,t,f,W,G,h){const m=E("resize-observer"),c=E("icon-close"),V=E("icon-hover");return S(),y("div",ae(e.getWrapperAttrs(e.$attrs),{class:e.wrapperCls,onMousedown:t[7]||(t[7]=(...o)=>e.handleMousedown&&e.handleMousedown(...o))}),[e.autoSize?(S(),y("div",{key:0,ref:"mirrorRef",class:O(`${e.prefixCls}-mirror`),style:ye(e.mirrorStyle)},P(`${e.computedValue}
`),7)):F("v-if",!0),M(m,{onResize:e.handleResize},{default:ee(()=>[Se("textarea",ae({ref:"textareaRef"},e.mergeTextareaAttrs,{disabled:e.mergedDisabled,class:e.prefixCls,style:e.textareaStyle,value:e.computedValue,placeholder:e.placeholder,onInput:t[0]||(t[0]=(...o)=>e.handleInput&&e.handleInput(...o)),onFocus:t[1]||(t[1]=(...o)=>e.handleFocus&&e.handleFocus(...o)),onBlur:t[2]||(t[2]=(...o)=>e.handleBlur&&e.handleBlur(...o)),onCompositionstart:t[3]||(t[3]=(...o)=>e.handleComposition&&e.handleComposition(...o)),onCompositionupdate:t[4]||(t[4]=(...o)=>e.handleComposition&&e.handleComposition(...o)),onCompositionend:t[5]||(t[5]=(...o)=>e.handleComposition&&e.handleComposition(...o))}),null,16,je)]),_:1},8,["onResize"]),we(e.$slots,"suffix"),e.computedMaxLength&&e.showWordLimit?(S(),y("div",{key:1,class:O(`${e.prefixCls}-word-limit`)},P(e.valueLength)+"/"+P(e.computedMaxLength),3)):F("v-if",!0),e.showClearBtn?(S(),y("div",{key:2,class:O(`${e.prefixCls}-clear-btn`),onClick:t[6]||(t[6]=(...o)=>e.handleClear&&e.handleClear(...o))},[M(V,null,{default:ee(()=>[M(c)]),_:1})],2)):F("v-if",!0)],16)}var D=Ce(Pe,[["render",De]]);const Ue=Object.assign(D,{install:(e,t)=>{He(e,t);const f=Ae(t);e.component(f+D.name,D)}});export{Ue as T};
