import{d as A,G as oe,m as P,H as re,p as h,J as U,K as ie,f as l,L as K,F as T,N as de,O as X,k as Z,P as ue,Q as ce,R as _e,c as x,o as y,b as a,n as se,l as ae,q as le,r as C,x as fe,w as i,B as me,j as L,v as u,D as pe,M as F,g as m,E as M,t as ee,s as te,i as ve}from"./index-XeR4dm_A.js";import"./index-CG2D6ptY.js";import"./index-DEcwfKP5.js";import{T as ge}from"./index-k17B4Fwt.js";import{T as be}from"./index-eIo3eb-K.js";import{u as ye,R as we,C as xe}from"./index-_Le4l-FT.js";import{S as he}from"./index-Bi8GYVuf.js";import{I as ke}from"./index-CMfuuKJw.js";import{I as $e}from"./index-Cwcf5wNo.js";var J=A({name:"Descriptions",props:{data:{type:Array,default:()=>[]},column:{type:[Number,Object],default:3},title:String,layout:{type:String,default:"horizontal"},align:{type:[String,Object],default:"left"},size:{type:String},bordered:{type:Boolean,default:!1},labelStyle:{type:Object},valueStyle:{type:Object},tableLayout:{type:String,default:"auto"}},setup(t,{slots:r}){const{column:c,size:v}=oe(t),o=P("descriptions"),{mergedSize:_}=re(v),d=ye(c,3,!0),O=h(()=>{var s;return(s=U(t.align)?t.align.label:t.align)!=null?s:"left"}),k=h(()=>{var s;return(s=U(t.align)?t.align.value:t.align)!=null?s:"left"}),S=h(()=>({textAlign:O.value,...t.labelStyle})),z=h(()=>({textAlign:k.value,...t.valueStyle})),D=s=>{const e=[];let n=[],p=0;const w=()=>{if(n.length){const b=d.value-p;n[n.length-1].span+=b,e.push(n)}};return s.forEach(b=>{var g,$;const N=Math.min(($=K(b)?(g=b.props)==null?void 0:g.span:b.span)!=null?$:1,d.value);p+N>d.value&&(w(),n=[],p=0),n.push({data:b,span:N}),p+=N}),w(),e},B=h(()=>{var s;return D((s=t.data)!=null?s:[])}),I=(s,e)=>{var n,p,w,b,g;return K(s)?de(s,s.children)&&((p=(n=s.children).label)==null?void 0:p.call(n))||((w=s.props)==null?void 0:w.label):(g=(b=r.label)==null?void 0:b.call(r,{label:s.label,index:e,data:s}))!=null?g:X(s.label)?s.label():s.label},j=(s,e)=>{var n,p;return K(s)?s:(p=(n=r.value)==null?void 0:n.call(r,{value:s.value,index:e,data:s}))!=null?p:X(s.value)?s.value():s.value},V=s=>l(T,null,[l("tr",{class:`${o}-row`},[s.map((e,n)=>l("td",{key:`label-${n}`,class:[`${o}-item-label`,`${o}-item-label-block`],style:S.value,colspan:e.span},[I(e.data,n)]))]),l("tr",{class:`${o}-row`},[s.map((e,n)=>l("td",{key:`value-${n}`,class:[`${o}-item-value`,`${o}-item-value-block`],style:z.value,colspan:e.span},[j(e.data,n)]))])]),E=(s,e)=>l("tr",{class:`${o}-row`,key:`tr-${e}`},[s.map(n=>l(T,null,[l("td",{class:[`${o}-item-label`,`${o}-item-label-block`],style:S.value},[I(n.data,e)]),l("td",{class:[`${o}-item-value`,`${o}-item-value-block`],style:z.value,colspan:n.span*2-1},[j(n.data,e)])]))]),H=(s,e)=>l("tr",{class:`${o}-row`,key:`inline-${e}`},[s.map((n,p)=>l("td",{key:`item-${p}`,class:`${o}-item`,colspan:n.span},[l("div",{class:[`${o}-item-label`,`${o}-item-label-inline`],style:S.value},[I(n.data,p)]),l("div",{class:[`${o}-item-value`,`${o}-item-value-inline`],style:z.value},[j(n.data,p)])]))]),q=(s,e)=>["inline-horizontal","inline-vertical"].includes(t.layout)?H(s,e):t.layout==="vertical"?V(s):E(s,e),W=h(()=>[o,`${o}-layout-${t.layout}`,`${o}-size-${_.value}`,{[`${o}-border`]:t.bordered},{[`${o}-table-layout-fixed`]:t.tableLayout==="fixed"}]),G=()=>{var s,e;const n=(e=(s=r.title)==null?void 0:s.call(r))!=null?e:t.title;return n?l("div",{class:`${o}-title`},[n]):null};return()=>{const s=r.default?D(ie(r.default())):B.value;return l("div",{class:W.value},[G(),l("div",{class:`${o}-body`},[l("table",{class:`${o}-table`},[l("tbody",null,[s.map((e,n)=>q(e,n))])])])])}}});const Se=A({name:"DescriptionsItem",props:{span:{type:Number,default:1},label:String},setup(){return{prefixCls:P("descriptions")}}});function Ce(t,r,c,v,o,_){return ue(t.$slots,"default")}var R=Z(Se,[["render",Ce]]);const ze=Object.assign(J,{DescriptionsItem:R,install:(t,r)=>{ce(t,r);const c=_e(r);t.component(c+J.name,J),t.component(c+R.name,R)}}),De=A({name:"IconArrowLeft",props:{size:{type:[Number,String]},strokeWidth:{type:Number,default:4},strokeLinecap:{type:String,default:"butt",validator:t=>["butt","round","square"].includes(t)},strokeLinejoin:{type:String,default:"miter",validator:t=>["arcs","bevel","miter","miter-clip","round"].includes(t)},rotate:Number,spin:Boolean},emits:{click:t=>!0},setup(t,{emit:r}){const c=P("icon"),v=h(()=>[c,`${c}-arrow-left`,{[`${c}-spin`]:t.spin}]),o=h(()=>{const d={};return t.size&&(d.fontSize=le(t.size)?`${t.size}px`:t.size),t.rotate&&(d.transform=`rotate(${t.rotate}deg)`),d});return{cls:v,innerStyle:o,onClick:d=>{r("click",d)}}}}),Ie=["stroke-width","stroke-linecap","stroke-linejoin"];function je(t,r,c,v,o,_){return y(),x("svg",{viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",stroke:"currentColor",class:ae(t.cls),style:se(t.innerStyle),"stroke-width":t.strokeWidth,"stroke-linecap":t.strokeLinecap,"stroke-linejoin":t.strokeLinejoin,onClick:r[0]||(r[0]=(...d)=>t.onClick&&t.onClick(...d))},r[1]||(r[1]=[a("path",{d:"M20.272 11.27 7.544 23.998l12.728 12.728M43 24H8.705"},null,-1)]),14,Ie)}var Q=Z(De,[["render",je]]);const Ne=Object.assign(Q,{install:(t,r)=>{var c;const v=(c=r?.iconPrefix)!=null?c:"";t.component(v+Q.name,Q)}}),Me=A({name:"IconArchive",props:{size:{type:[Number,String]},strokeWidth:{type:Number,default:4},strokeLinecap:{type:String,default:"butt",validator:t=>["butt","round","square"].includes(t)},strokeLinejoin:{type:String,default:"miter",validator:t=>["arcs","bevel","miter","miter-clip","round"].includes(t)},rotate:Number,spin:Boolean},emits:{click:t=>!0},setup(t,{emit:r}){const c=P("icon"),v=h(()=>[c,`${c}-archive`,{[`${c}-spin`]:t.spin}]),o=h(()=>{const d={};return t.size&&(d.fontSize=le(t.size)?`${t.size}px`:t.size),t.rotate&&(d.transform=`rotate(${t.rotate}deg)`),d});return{cls:v,innerStyle:o,onClick:d=>{r("click",d)}}}}),Ae=["stroke-width","stroke-linecap","stroke-linejoin"];function Oe(t,r,c,v,o,_){return y(),x("svg",{viewBox:"0 0 48 48",fill:"none",stroke:"currentColor",xmlns:"http://www.w3.org/2000/svg",class:ae(t.cls),style:se(t.innerStyle),"stroke-width":t.strokeWidth,"stroke-linecap":t.strokeLinecap,"stroke-linejoin":t.strokeLinejoin,onClick:r[0]||(r[0]=(...d)=>t.onClick&&t.onClick(...d))},r[1]||(r[1]=[a("rect",{x:"9",y:"18",width:"30",height:"22",rx:"1"},null,-1),a("path",{d:"M6 9a1 1 0 0 1 1-1h34a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V9ZM19 27h10"},null,-1)]),14,Ae)}var Y=Z(Me,[["render",Oe]]);const Be=Object.assign(Y,{install:(t,r)=>{var c;const v=(c=r?.iconPrefix)!=null?c:"";t.component(v+Y.name,Y)}}),Le={class:"p-6"},Re={class:"mb-6"},Te={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6"},Pe={class:"flex items-start justify-between mb-6"},Ve={class:"flex items-center space-x-4"},Ee={class:"w-16 h-16 bg-blue-50 rounded-lg flex items-center justify-center"},He={class:"text-2xl font-bold text-gray-900 mb-1"},qe={class:"text-gray-600"},We={class:"text-center p-4 bg-gray-50 rounded-lg"},Ge={class:"text-2xl font-bold text-blue-600 mb-1"},Ke={class:"text-center p-4 bg-gray-50 rounded-lg"},Fe={class:"text-2xl font-bold text-green-600 mb-1"},Je={class:"text-center p-4 bg-gray-50 rounded-lg"},Qe={class:"text-2xl font-bold text-purple-600 mb-1"},Ye={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6"},Ze={class:"text-xs bg-gray-100 px-2 py-1 rounded"},Ue={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6"},Xe={class:"flex items-center space-x-2"},et={key:0,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},tt={class:"bg-gray-50 p-4 rounded-lg text-sm overflow-auto"},st={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6"},at={class:"space-y-2"},lt={key:0,class:"text-gray-500 text-sm"},nt={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6"},ot={class:"space-y-3"},rt={class:"flex justify-between"},it={class:"font-medium"},dt={class:"flex justify-between"},ut={class:"font-medium"},ct={class:"flex justify-between"},_t={class:"font-medium"},ft={class:"flex justify-between"},mt={class:"font-medium"},pt={class:"flex justify-between"},vt={class:"font-medium"},gt={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},bt={class:"space-y-3"},yt={class:"flex items-center justify-between mb-2"},wt={class:"font-medium"},xt={key:0,class:"text-sm text-gray-600"},ht={class:"text-red-600"},kt={class:"text-orange-600"},$t={class:"text-yellow-600"},St={key:0,class:"text-gray-500 text-sm"},Bt=A({__name:"ArtifactDetailView",setup(t){const r=pe(),c=ve(),v=C(!1),o=C(!1),_=C(null),d=C(null),O=C([]),k=C(null),S=C([]),z=[{title:"版本",dataIndex:"version",slotName:"version",width:120},{title:"大小",dataIndex:"size",slotName:"size",width:100},{title:"创建时间",dataIndex:"created_at",slotName:"created_at"}];function D(s){return s?new Date(s).toLocaleString("zh-CN"):"N/A"}function B(s){if(!s)return"N/A";const e=["B","KB","MB","GB","TB"],n=Math.floor(Math.log(s)/Math.log(1024));return`${Math.round(s/1024**n*100)/100} ${e[n]}`}function I(s){return{DOCKER:"blue",NPM:"green",JAR:"orange",MAVEN:"red",PYPI:"yellow"}[s||""]||"gray"}function j(s){return{vulnerability:"漏洞扫描",license:"许可证扫描",quality:"质量扫描"}[s]||s}function V(s){return{pending:"gray",scanning:"blue",completed:"green",failed:"red"}[s]||"gray"}function E(s){return{pending:"等待中",scanning:"扫描中",completed:"已完成",failed:"失败"}[s]||s}function H(){c.go(-1)}async function q(){try{o.value=!0,F.success("下载开始")}catch(s){console.error(s),F.error("下载失败")}finally{o.value=!1}}function W(){c.push(`/artifacts/${r.params.id}/downloads`)}async function G(){try{v.value=!0;const s=r.params.id;console.warn("artifactId",s),_.value={id:1,project_id:1,repo_id:1,name:"web-frontend",version:"v1.0.0",type_id:1,path:"myorg/web-frontend:v1.0.0",created_at:new Date().toISOString(),project:{id:1,name:"Web前端项目",repo_url:"",branch:"",build_cmd:"",image_name:"",created_at:"",updated_at:""},artifact_repo:{id:1,name:"Docker Hub",type_id:1,url:"docker.io",created_at:"",updated_at:""},artifact_type:{id:1,name:"DOCKER",description:"Docker镜像",created_at:""}},d.value={..._.value,size:1024*1024*150,digest:"sha256:abc123def456...",tags:["latest","stable","v1.0.0"],download_count:1250,last_download_at:new Date().toISOString(),metadata:{architecture:"amd64",os:"linux",created:new Date().toISOString(),author:"DevOps Team"}},O.value=[{id:1,artifact_id:1,version:"v1.0.0",size:1024*1024*150,created_at:new Date().toISOString(),is_latest:!0},{id:2,artifact_id:1,version:"v0.9.0",size:1024*1024*145,created_at:new Date(Date.now()-864e5).toISOString(),is_latest:!1}],k.value={artifact_id:1,daily_downloads:25,weekly_downloads:180,monthly_downloads:750,total_downloads:1250,unique_users:85,last_used_at:new Date().toISOString()},S.value=[{id:1,artifact_id:1,scan_type:"vulnerability",status:"completed",result:{high_issues:0,medium_issues:2,low_issues:5},scanned_at:new Date().toISOString()}]}catch(s){console.error(s),F.error("加载制品详情失败")}finally{v.value=!1}}return fe(()=>{G()}),(s,e)=>{const n=me,p=he,w=xe,b=we,g=R,$=ge,N=ze,ne=be;return y(),x("div",Le,[a("div",Re,[l(n,{class:"mb-4",onClick:H},{icon:i(()=>[l(L(Ne))]),default:i(()=>[e[0]||(e[0]=m(" 返回列表 ",-1))]),_:1,__:[0]})]),a("div",Te,[a("div",Pe,[a("div",Ve,[a("div",Ee,[l(L(Be),{class:"text-blue-600 text-2xl"})]),a("div",null,[a("h1",He,u(_.value?.name),1),a("p",qe,u(_.value?.path),1)])]),l(p,null,{default:i(()=>[l(n,{type:"primary",loading:o.value,onClick:q},{icon:i(()=>[l(L(ke))]),default:i(()=>[e[1]||(e[1]=m(" 下载制品 ",-1))]),_:1,__:[1]},8,["loading"]),l(n,{onClick:W},{icon:i(()=>[l(L($e))]),default:i(()=>[e[2]||(e[2]=m(" 下载记录 ",-1))]),_:1,__:[2]})]),_:1})]),l(b,{gutter:24},{default:i(()=>[l(w,{span:8},{default:i(()=>[a("div",We,[a("p",Ge,u(_.value?.version),1),e[3]||(e[3]=a("p",{class:"text-sm text-gray-600"}," 当前版本 ",-1))])]),_:1}),l(w,{span:8},{default:i(()=>[a("div",Ke,[a("p",Fe,u(B(d.value?.size)),1),e[4]||(e[4]=a("p",{class:"text-sm text-gray-600"}," 制品大小 ",-1))])]),_:1}),l(w,{span:8},{default:i(()=>[a("div",Je,[a("p",Qe,u(d.value?.download_count||0),1),e[5]||(e[5]=a("p",{class:"text-sm text-gray-600"}," 下载次数 ",-1))])]),_:1})]),_:1})]),l(b,{gutter:24},{default:i(()=>[l(w,{span:16},{default:i(()=>[a("div",Ye,[e[6]||(e[6]=a("h3",{class:"text-lg font-semibold text-gray-900 mb-4"}," 基本信息 ",-1)),l(N,{column:2,bordered:""},{default:i(()=>[l(g,{label:"制品名称"},{default:i(()=>[m(u(_.value?.name),1)]),_:1}),l(g,{label:"版本号"},{default:i(()=>[m(u(_.value?.version),1)]),_:1}),l(g,{label:"制品类型"},{default:i(()=>[l($,{color:I(_.value?.artifact_type?.name)},{default:i(()=>[m(u(_.value?.artifact_type?.name),1)]),_:1},8,["color"])]),_:1}),l(g,{label:"所属项目"},{default:i(()=>[m(u(_.value?.project?.name),1)]),_:1}),l(g,{label:"仓库地址"},{default:i(()=>[m(u(_.value?.artifact_repo?.name),1)]),_:1}),l(g,{label:"创建时间"},{default:i(()=>[m(u(D(_.value?.created_at)),1)]),_:1}),l(g,{label:"制品路径",span:2},{default:i(()=>[m(u(_.value?.path),1)]),_:1}),l(g,{label:"摘要值",span:2},{default:i(()=>[a("code",Ze,u(d.value?.digest||"N/A"),1)]),_:1})]),_:1})]),a("div",Ue,[e[8]||(e[8]=a("h3",{class:"text-lg font-semibold text-gray-900 mb-4"}," 版本历史 ",-1)),l(ne,{columns:z,data:O.value,pagination:!1,size:"small"},{version:i(({record:f})=>[a("div",Xe,[l($,{color:f.is_latest?"green":"blue"},{default:i(()=>[m(u(f.version),1)]),_:2},1032,["color"]),f.is_latest?(y(),ee($,{key:0,color:"green",size:"small"},{default:i(()=>e[7]||(e[7]=[m(" 最新 ",-1)])),_:1,__:[7]})):M("",!0)])]),size:i(({record:f})=>[m(u(B(f.size)),1)]),created_at:i(({record:f})=>[m(u(D(f.created_at)),1)]),_:1},8,["data"])]),d.value?.metadata?(y(),x("div",et,[e[9]||(e[9]=a("h3",{class:"text-lg font-semibold text-gray-900 mb-4"}," 元数据信息 ",-1)),a("pre",tt,u(JSON.stringify(d.value.metadata,null,2)),1)])):M("",!0)]),_:1}),l(w,{span:8},{default:i(()=>[a("div",st,[e[10]||(e[10]=a("h3",{class:"text-lg font-semibold text-gray-900 mb-4"}," 标签 ",-1)),a("div",at,[(y(!0),x(T,null,te(d.value?.tags,f=>(y(),ee($,{key:f,color:"blue"},{default:i(()=>[m(u(f),1)]),_:2},1024))),128)),d.value?.tags?.length?M("",!0):(y(),x("p",lt," 暂无标签 "))])]),a("div",nt,[e[16]||(e[16]=a("h3",{class:"text-lg font-semibold text-gray-900 mb-4"}," 使用统计 ",-1)),a("div",ot,[a("div",rt,[e[11]||(e[11]=a("span",{class:"text-gray-600"},"今日下载",-1)),a("span",it,u(k.value?.daily_downloads||0),1)]),a("div",dt,[e[12]||(e[12]=a("span",{class:"text-gray-600"},"本周下载",-1)),a("span",ut,u(k.value?.weekly_downloads||0),1)]),a("div",ct,[e[13]||(e[13]=a("span",{class:"text-gray-600"},"本月下载",-1)),a("span",_t,u(k.value?.monthly_downloads||0),1)]),a("div",ft,[e[14]||(e[14]=a("span",{class:"text-gray-600"},"总下载量",-1)),a("span",mt,u(k.value?.total_downloads||0),1)]),a("div",pt,[e[15]||(e[15]=a("span",{class:"text-gray-600"},"独立用户",-1)),a("span",vt,u(k.value?.unique_users||0),1)])])]),a("div",gt,[e[19]||(e[19]=a("h3",{class:"text-lg font-semibold text-gray-900 mb-4"}," 安全扫描 ",-1)),a("div",bt,[(y(!0),x(T,null,te(S.value,f=>(y(),x("div",{key:f.id,class:"p-3 border rounded-lg"},[a("div",yt,[a("span",wt,u(j(f.scan_type)),1),l($,{color:V(f.status)},{default:i(()=>[m(u(E(f.status)),1)]),_:2},1032,["color"])]),f.result?(y(),x("div",xt,[a("span",ht,"高危: "+u(f.result.high_issues),1),e[17]||(e[17]=m(" | ",-1)),a("span",kt,"中危: "+u(f.result.medium_issues),1),e[18]||(e[18]=m(" | ",-1)),a("span",$t,"低危: "+u(f.result.low_issues),1)])):M("",!0)]))),128)),S.value.length?M("",!0):(y(),x("p",St," 暂无扫描结果 "))])])]),_:1})]),_:1})])}}});export{Bt as default};
