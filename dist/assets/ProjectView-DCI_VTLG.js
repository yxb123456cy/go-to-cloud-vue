import{k as ee,d as T,c as j,o as B,b as u,n as te,l as ae,m as ne,p as N,q as oe,r as b,a as S,x as le,f as t,w as n,B as re,M as p,g as _,j as v,v as h,i as ie}from"./index-XeR4dm_A.js";/* empty css              */import{R as se,C as de,b as ue,I as me}from"./index-_Le4l-FT.js";import{F as ce,a as pe}from"./index-DblMJEe-.js";import{T as _e}from"./index-BCkAYXOZ.js";import"./index-CG2D6ptY.js";import"./index-DEcwfKP5.js";import{T as fe}from"./index-k17B4Fwt.js";import{T as ge,I as be}from"./index-eIo3eb-K.js";import{S as ve}from"./index-Bi8GYVuf.js";import{M as D}from"./index-DUMfmY3d.js";import{I as ye}from"./index-CHSk6fru.js";import{I as we}from"./index-Cwcf5wNo.js";import{I as he}from"./index-Bqg0be0K.js";import{I as ke}from"./index-MIkPKJzQ.js";const xe=T({name:"IconPlayArrow",props:{size:{type:[Number,String]},strokeWidth:{type:Number,default:4},strokeLinecap:{type:String,default:"butt",validator:l=>["butt","round","square"].includes(l)},strokeLinejoin:{type:String,default:"miter",validator:l=>["arcs","bevel","miter","miter-clip","round"].includes(l)},rotate:Number,spin:Boolean},emits:{click:l=>!0},setup(l,{emit:d}){const i=ne("icon"),m=N(()=>[i,`${i}-play-arrow`,{[`${i}-spin`]:l.spin}]),c=N(()=>{const s={};return l.size&&(s.fontSize=oe(l.size)?`${l.size}px`:l.size),l.rotate&&(s.transform=`rotate(${l.rotate}deg)`),s});return{cls:m,innerStyle:c,onClick:s=>{d("click",s)}}}}),Ce=["stroke-width","stroke-linecap","stroke-linejoin"];function Ie(l,d,i,m,c,k){return B(),j("svg",{viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",stroke:"currentColor",class:ae(l.cls),style:te(l.innerStyle),"stroke-width":l.strokeWidth,"stroke-linecap":l.strokeLinecap,"stroke-linejoin":l.strokeLinejoin,onClick:d[0]||(d[0]=(...s)=>l.onClick&&l.onClick(...s))},d[1]||(d[1]=[u("path",{d:"M12.533 7.965A1 1 0 0 0 11 8.81v30.377a1 1 0 0 0 1.533.846L36.656 24.84a1 1 0 0 0 0-1.692L12.533 7.965Z"},null,-1)]),14,Ce)}var V=ee(xe,[["render",Ie]]);const Se=Object.assign(V,{install:(l,d)=>{var i;const m=(i=d?.iconPrefix)!=null?i:"";l.component(m+V.name,V)}}),Ve={class:"p-6 bg-gray-50 min-h-screen"},Pe={class:"flex items-center justify-between mb-6"},ze={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-6"},$e={class:"bg-white rounded-lg shadow-sm border border-gray-200"},Ne={class:"font-medium text-gray-900"},De={class:"text-sm text-gray-500"},Te={class:"text-sm bg-gray-100 px-2 py-1 rounded"},Je=T({__name:"ProjectView",setup(l){const d=ie(),i=b(!1),m=b(!1),c=b(null),k=b([]),s=b([]),C=b(),r=S({name:"",repo_url:"",branch:"main",build_cmd:"",image_name:""}),P=S({keyword:""}),y=S({current:1,pageSize:10,total:0,showSizeChanger:!0,showTotal:!0}),L=[{title:"项目信息",dataIndex:"name",slotName:"name",width:300},{title:"分支",dataIndex:"branch",slotName:"branch",width:100},{title:"构建命令",dataIndex:"build_cmd",width:200,ellipsis:!0},{title:"镜像名称",dataIndex:"image_name",slotName:"image_name",width:250},{title:"创建时间",dataIndex:"created_at",slotName:"created_at",width:180},{title:"操作",slotName:"actions",width:250,align:"center"}],q={name:[{required:!0,message:"请输入项目名称"},{minLength:2,message:"项目名称至少2个字符"}],repo_url:[{required:!0,message:"请输入代码仓库地址"}],branch:[{required:!0,message:"请输入代码分支"}],build_cmd:[{required:!0,message:"请输入构建命令"}],image_name:[{required:!0,message:"请输入镜像名称"}]};function M(o){return new Date(o).toLocaleString("zh-CN")}function z(){r.name="",r.repo_url="",r.branch="main",r.build_cmd="",r.image_name="",c.value=null,m.value=!1,C.value?.resetFields()}function O(o){y.current=o,f()}function U(o){y.pageSize=o,y.current=1,f()}function R(o){c.value=o,r.name=o.name,r.repo_url=o.repo_url,r.branch=o.branch,r.build_cmd=o.build_cmd,r.image_name=o.image_name,m.value=!0}function A(o){D.confirm({title:"确认删除",content:`确定要删除项目 "${o.name}" 吗？此操作不可恢复。`,onOk:async()=>{try{p.success("删除成功"),f()}catch(e){console.error(e),p.error("删除失败")}}})}async function F(o){try{s.value.push(o.id),p.success(`项目 ${o.name} 构建任务已启动`)}catch(e){console.error(e),p.error("启动构建失败")}finally{s.value=s.value.filter(e=>e!==o.id)}}function W(o){d.push(`/builds?projectId=${o.id}`)}async function E(){try{if(!await C.value?.validate())return;i.value=!0,c.value?p.success("更新成功"):p.success("创建成功"),z(),f()}catch(o){console.error(o),p.error(c.value?"更新失败":"创建失败")}finally{i.value=!1}}async function f(){try{i.value=!0,k.value=[{id:1,name:"Web前端项目",repo_url:"https://github.com/example/web-frontend.git",branch:"main",build_cmd:"npm install && npm run build",image_name:"registry.example.com/web-frontend:latest",created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{id:2,name:"API服务",repo_url:"https://github.com/example/api-service.git",branch:"develop",build_cmd:"mvn clean package -DskipTests",image_name:"registry.example.com/api-service:latest",created_at:new Date(Date.now()-864e5).toISOString(),updated_at:new Date(Date.now()-864e5).toISOString()}],y.total=2}catch(o){console.error(o),p.error("加载项目列表失败")}finally{i.value=!1}}return le(()=>{f()}),(o,e)=>{const g=re,G=ue,$=de,H=se,Z=fe,J=ve,K=ge,x=me,w=pe,Q=_e,X=ce,Y=D;return B(),j("div",Ve,[u("div",Pe,[e[9]||(e[9]=u("div",null,[u("h1",{class:"text-2xl font-bold text-gray-900 mb-2"}," 项目管理 "),u("p",{class:"text-gray-600"}," 管理代码项目及构建配置 ")],-1)),t(g,{type:"primary",onClick:e[0]||(e[0]=a=>m.value=!0)},{icon:n(()=>[t(v(be))]),default:n(()=>[e[8]||(e[8]=_(" 新建项目 ",-1))]),_:1,__:[8]})]),u("div",ze,[t(H,{gutter:16},{default:n(()=>[t($,{span:8},{default:n(()=>[t(G,{modelValue:P.keyword,"onUpdate:modelValue":e[1]||(e[1]=a=>P.keyword=a),placeholder:"搜索项目名称或仓库地址",onSearch:f},null,8,["modelValue"])]),_:1}),t($,{span:4},{default:n(()=>[t(g,{onClick:f},{icon:n(()=>[t(v(ye))]),default:n(()=>[e[10]||(e[10]=_(" 刷新 ",-1))]),_:1,__:[10]})]),_:1})]),_:1})]),u("div",$e,[t(K,{columns:L,data:k.value,loading:i.value,pagination:y,onPageChange:O,onPageSizeChange:U},{name:n(({record:a})=>[u("div",null,[u("p",Ne,h(a.name),1),u("p",De,h(a.repo_url),1)])]),branch:n(({record:a})=>[t(Z,{color:"blue"},{default:n(()=>[_(h(a.branch),1)]),_:2},1024)]),image_name:n(({record:a})=>[u("code",Te,h(a.image_name),1)]),created_at:n(({record:a})=>[_(h(M(a.created_at)),1)]),actions:n(({record:a})=>[t(J,null,{default:n(()=>[t(g,{type:"text",size:"small",loading:s.value.includes(a.id),onClick:I=>F(a)},{icon:n(()=>[t(v(Se))]),default:n(()=>[e[11]||(e[11]=_(" 构建 ",-1))]),_:2,__:[11]},1032,["loading","onClick"]),t(g,{type:"text",size:"small",onClick:I=>W(a)},{icon:n(()=>[t(v(we))]),default:n(()=>[e[12]||(e[12]=_(" 构建历史 ",-1))]),_:2,__:[12]},1032,["onClick"]),t(g,{type:"text",size:"small",onClick:I=>R(a)},{icon:n(()=>[t(v(he))]),default:n(()=>[e[13]||(e[13]=_(" 编辑 ",-1))]),_:2,__:[13]},1032,["onClick"]),t(g,{type:"text",size:"small",status:"danger",onClick:I=>A(a)},{icon:n(()=>[t(v(ke))]),default:n(()=>[e[14]||(e[14]=_(" 删除 ",-1))]),_:2,__:[14]},1032,["onClick"])]),_:2},1024)]),_:1},8,["data","loading","pagination"])]),t(Y,{visible:m.value,"onUpdate:visible":e[7]||(e[7]=a=>m.value=a),title:c.value?"编辑项目":"新建项目",width:"600px",onOk:E,onCancel:z},{default:n(()=>[t(X,{ref_key:"formRef",ref:C,model:r,rules:q,layout:"vertical"},{default:n(()=>[t(w,{field:"name",label:"项目名称"},{default:n(()=>[t(x,{modelValue:r.name,"onUpdate:modelValue":e[2]||(e[2]=a=>r.name=a),placeholder:"请输入项目名称"},null,8,["modelValue"])]),_:1}),t(w,{field:"repo_url",label:"代码仓库地址"},{default:n(()=>[t(x,{modelValue:r.repo_url,"onUpdate:modelValue":e[3]||(e[3]=a=>r.repo_url=a),placeholder:"请输入Git仓库地址"},null,8,["modelValue"])]),_:1}),t(w,{field:"branch",label:"代码分支"},{default:n(()=>[t(x,{modelValue:r.branch,"onUpdate:modelValue":e[4]||(e[4]=a=>r.branch=a),placeholder:"请输入分支名称"},null,8,["modelValue"])]),_:1}),t(w,{field:"build_cmd",label:"构建命令"},{default:n(()=>[t(Q,{modelValue:r.build_cmd,"onUpdate:modelValue":e[5]||(e[5]=a=>r.build_cmd=a),placeholder:"请输入构建命令，如：npm run build",rows:3},null,8,["modelValue"])]),_:1}),t(w,{field:"image_name",label:"镜像名称"},{default:n(()=>[t(x,{modelValue:r.image_name,"onUpdate:modelValue":e[6]||(e[6]=a=>r.image_name=a),placeholder:"请输入Docker镜像名称"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","title"])])}}});export{Je as default};
